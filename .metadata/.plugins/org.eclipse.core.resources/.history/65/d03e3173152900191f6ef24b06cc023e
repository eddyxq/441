package cpsc441.a1;

import java.io.ByteArrayOutputStream;
import java.io.DataOutputStream;
import java.io.IOException;

public class QuickUrl extends ConcurrentHttp {

	public void setConn(int conn) {
		// TODO Auto-generated method stub
		
	}

	public void getObject(String url) {
		// TODO Auto-generated method stub
		
	}

	public void parse(String url) 
	{
		//String[] parts = new String[2];
		
		String [] parts = url.split("/", 2);
		
		//System.out.println(parts[0]);
		//System.out.println(parts[1]);
		
		
		
		//if the url has a port specified
		if(parts[0].contains(":"))
		{ 
			String [] hostandport = parts[0].split(":", 2);
			String host = hostandport[0];
			String port = hostandport[1];
			String filepath = "/" + parts[1];
			
			System.out.println(host);
			System.out.println(port);
			System.out.println(filepath);
			
		}
		//if the url has not a port specified
		else
		{ 
			String host = parts[0];
			String port = "80"; // defaults port to 80 if not specified
			String filepath = "/" + parts[1];
			
			System.out.println(host);
			System.out.println(port);
			System.out.println(filepath);
		}
	}
	
	public void sendHeadRequest(String pathname, String hostname, String port) 
	{
		ByteArrayOutputStream boas = new ByteArrayOutputStream();
		DataOutputStream outputstream = new DataOutputStream(boas);
		String requestLine_1 = "HEAD" + pathname + "HTTP/1.1\r\n";
		String requestLine_2 = "Host: " + hostname + ":" + port + "\r\n";
		String eoh_line = "\r\n";

		try
		{
			String http_header = requestLine_1 + requestLine_2 + eoh_line;
			byte[] http_header_in_bytes = http_header.getBytes("US-ASCII");
			outputstream.write(http_header_in_bytes);
			outputstream.flush();
		}
		catch (IOException e)
		{
			// code for Exception Handling
		}
	}
	
	public void sendRangeRequest() 
	{
		
	}

}
